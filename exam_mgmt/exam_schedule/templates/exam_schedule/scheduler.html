{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>School Exam Scheduler</title>

  <link rel="stylesheet" href="{% static 'exam_schedule/css/style.css' %}" />
</head>

<body>


  <div class="wrap">
    <header>
      <div>
        <h1>ðŸ“š Exam Scheduler</h1>
        <div class="help">Plan exams across classes with built-in clash checks (class, hall, invigilator) and a minimum
          gap rule.</div>
      </div>
      <div class="actions">
        <button id="btnValidate" class="btn">Validate</button>
        <button id="btnPrint" class="btn ghost">Print <span class="kbd">Ctrl+P</span></button>
      </div>
    </header>


    <section class="card">
      <div class="grid g-3">
        <div>
          <label for="term">Term / Session</label>
          <input id="term" name="term" placeholder="e.g., 2082 (BS) / 2025" />
        </div>
        <div>
          <label for="windowStart">Window Start</label>
          <input id="windowStart" type="date" />
        </div>
        <div>
          <label for="windowEnd">Window End</label>
          <input id="windowEnd" type="date" />
        </div>
      </div>
      <div class="grid g-3" style="margin-top:12px">
        <div>
          <label for="minGap">Minimum gap between a class's papers (days)</label>
          <input id="minGap" type="number" min="0" value="1" />
        </div>
        <div>
          <label for="defaultDuration">Default duration (minutes)</label>
          <input id="defaultDuration" type="number" min="30" step="5" value="90" />
        </div>
        <div>
          <label for="schoolName">School (optional)</label>
          <input id="schoolName" placeholder="e.g., Butwal Kalika" />
        </div>
      </div>
    </section>


    <section class="card">
      <h2>âž• Exam</h2>
      <form id="examForm" method="POST">
        {% csrf_token %}

        <input type="hidden" id="editingId" />
        <div class="grid g-4">
          <div>
            <label for="klass">Course</label>
            <select id="klass" name="course" required>
              <option value="" disabled selected>Select class</option>
               <option>BCA</option>
            </select>
          </div>
          <div>
            <label for="semester">Semester</label>
            <select id="semester" name="semester">
              <option value = "1">1st semester</option>
              <option value = "2">2nd semester</option>
              <option value = "3">3rd semester</option>
              <option value = "4">4rd semester</option>
              <option value = "5">5th semester</option>
              <option value = "6">6th semester</option>
              <option value = "7">7th semester</option>
              <option value = "8">8th semester</option>
            </select>
          </div>
          <div>
            <label for="subject">Subject</label>
            <select id = "subject" name="subject" required >
                    
              <!-- Options will be populated by JavaScript -->
            

                <option value="" disabled selected>select subject</option>
              </select>
    
          </div>
          <div>
            <label for="paper">Subject Code</label>
            <input id="paper" name="paper_code" placeholder="auto-filled from subject" />
          </div>
        </div>
        <div class="grid g-4" style="margin-top:12px">
          <div>
            <label for="date">Date</label>
            <input id="date" name="date" type="date" required />
          </div>
          <div>
            <label for="start">Start Time</label>
            <input id="start" name="start_time" type="time" required />
          </div>
          <div>
            <label for="duration">Duration (minutes)</label>
            <input id="duration" name="duration" type="number" min="30" step="5" />
          </div>
          <div>
            <label for="hall">Hall / Room</label>
            <input id="hall" name="hall" placeholder="e.g., Hall A or 302" />
          </div>
        </div>
        <div class="grid g-3" style="margin-top:12px">
          <div>
            <label for="candidates">Expected Candidates</label>
            <input id="candidates" name="candidates" type="number" min="0" placeholder="e.g., 60" />
          </div>
          <div>
            <label for="invigilators">Invigilator(s)</label>
            <select id="invigilators" name="invigilators" >
              <!-- Options will be populated by JavaScript -->
            </select>
          </div>
          <div>
            <label for="notes">Notes</label>
            <input id="notes" name="notes" placeholder="Any special instructions" />
          </div>
        </div>
        <div class="toolbar" style="margin-top:12px">
          <div class="left stack">
            <button id="btnAdd" class="btn primary" type="submit">Save Exam</button>
            <button id="btnReset" class="btn" type="reset">Clear</button>
          </div>
          <div class="right stack">
            <button id="btnExportJSON" class="btn ok" type="button">Export JSON</button>
            <button id="btnExportCSV" class="btn" type="button">Export CSV</button>
            <button id="btnClearAll" class="btn bad" type="button">Clear All</button>
          </div>
        </div>
        <p class="help" style="margin-top:8px">Tip: leave <span class="kbd">Section</span> blank to schedule for the
          whole class (all sections).</p>
             
      </form>
    </section>
    <section class = "card">

  <button id="btnAutoFill" class="btn ok" type="button">Automatic Scheduling</button>
</section>

 


    <section class="card">
      <div class="toolbar">
        <div class="left">
          <h2>ðŸ“‹ Schedule</h2>
        </div>
        <div class="right">
          <label class="pill">Filter Class
            <select id="filterClass" style="background:transparent;border:none;color:var(--ink);">
              <option value="">All</option>
              <option>BCA</option>
              <option>BBS</option>
              <option>B.ED</option>
              <option>BBA</option>

            </select>
          </label>
          <label class="pill">Semester
            <select id="filterSemester" style="background:transparent;border:none;color:var(--ink);">
              <option value="">All</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
            </select>
          </label>
          <button id="btnSort" class="btn">Sort by Date/Time</button>
        </div>
      </div>


      <div class="notice" id="validationSummary" style="display:none;margin-top:8px"></div>

      <div style="max-height:420px;overflow:auto;margin-top:8px">
        <table id="table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Start</th>
              <th>End</th>
              <th>Class</th>
              <th>Section</th>
              <th>Subject</th>
              <th>Paper</th>
              <th>Hall</th>
              <th>Invigilators</th>
              <th>Duration</th>
              <th>Candidates</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>


    <div class="footer">Â© Exam Management â€” Scheduler</div>
  </div>


  {# Embed initial exams safely using Django's json_script filter #}
  {{ exams_list|json_script:"init-exams" }}
  <script src="{% static 'exam_schedule/js/script.js' %}"></script>

</body>

</html>